
What are the top 5 brands by receipts scanned for most recent month?
SELECT TOP 5 (B.name)
FROM Receipt AS R INNER JOIN rewardsReceiptItemList AS ITEM ON B._id=R.brandId
INNER JOIN Brands AS B ON ITEM.brandCode=B.brandCode
WHERE topBrand='T' AND MONTH(R.dateScanned)=(SELECT MONTH(R.dateScanned)
                                              FROM Receipt
                                              ORDER BY R.dateScanned DESC LIMIT 1)
ORDER BY COUNT(ITEM.brandCode) DESC



How does the ranking of the top 5 brands by receipts scanned for the recent month compare to the ranking for the previous month?
SELECT TOP 5 COUNT(B.name)
FROM Brands AS B LEFT JOIN Receipt AS R ON B._id=R.brandId
WHERE topBrand='T' AND MONTH(R.dateScanned)=(SELECT MONTH(R.dateScanned)              
                                              FROM Receipt
                                              ORDER BY R.dateScanned DESC LIMIT 2)
ORDER BY COUNT(ITEM.brandCode)


When considering average spend from
receipts with 'rewardsReceiptStatus’ of ‘Accepted’ or ‘Rejected’, which is greater?

SELECT AVG(totalSpent)
FROM Receipts
GROUP BY rewardsReceiptStatus
HAVING rewardsReceiptStatus="Accepted" OR rewardsReceiptStatus="Rejected"



When considering total number of items purchased from
receipts with 'rewardsReceiptStatus’ of ‘Accepted’ or ‘Rejected’, which is greater?

SELECT COUNT(purchasedItemCount)
FROM Receipts
GROUP BY rewardsReceiptStatus
HAVING rewardsReceiptStatus="Accepted" OR rewardsReceiptStatus="Rejected"